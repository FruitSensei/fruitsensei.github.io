function changeColor(e){"blue"==e?(lightsaberColor="#00ffff",laserColor="#ff3346"):"green"==e?(lightsaberColor="#05B805",laserColor="#ff3346"):"red"==e&&(lightsaberColor="#ff0000",laserColor="#00ffff")}function changeBlue(){document.getElementById("blueSaber").style.opacity="1",document.getElementById("redSaber").style.opacity="0.5",document.getElementById("greenSaber").style.opacity="0.5",lightsaberColor="#00ffff",laserColor="#ff3346"}function changeGreen(){document.getElementById("greenSaber").style.opacity="1",document.getElementById("blueSaber").style.opacity="0.5",document.getElementById("redSaber").style.opacity="0.5",lightsaberColor="#05B805",laserColor="#ff3346"}function changeRed(){document.getElementById("redSaber").style.opacity="1",document.getElementById("blueSaber").style.opacity="0.5",document.getElementById("greenSaber").style.opacity="0.5",lightsaberColor="#ff0000",laserColor="#00ffff"}if(/Mobi/.test(navigator.userAgent))var isMobile=!0;var score=0,timer=65,gameOver=!1,lightsaberColor="#00ffff",laserColor="#ff3346";!function e(r,a,n){function t(o,s){if(!a[o]){if(!r[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var c=a[o]={exports:{}};r[o][0].call(c.exports,function(e){var a=r[o][1][e];return t(a?a:e)},c,c.exports,e,r,a,n)}return a[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)t(n[o]);return t}({1:[function(e,r,a){function n(e){var r=new THREE.Object3D,a=new THREE.PlaneGeometry(100,150),n=e.load("/textures/wall_deathstar.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(5,5);var t=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:n}),i=new THREE.PlaneGeometry(100,70),o=new THREE.MeshBasicMaterial({color:"green"}),s=new THREE.PlaneGeometry(70,150),l=e.load("/textures/floor_metal.jpg");l.wrapS=THREE.RepeatWrapping,l.wrapT=THREE.RepeatWrapping,l.repeat.set(5,5);var d=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:l}),c=new THREE.Mesh(a,t);c.position.set(20,0,-35);var w=c.clone();w.position.set(20,0,35),w.rotateY(Math.PI);var E=new THREE.Mesh(s,d);E.rotateY(Math.PI/2),E.position.set(-20,0,0);var m=new THREE.Mesh(i,o);return m.rotateX(-Math.PI/2),m.position.set(-20,50,0),r.add(c,w,E,m),r}r.exports=n},{}],2:[function(e,r,a){function n(){var e=new THREE.CylinderGeometry(.9,.9,4,12),r=new THREE.MeshBasicMaterial({transparent:!0,opacity:.75,color:laserColor}),a=new THREE.Mesh(e,r);return a.rotateZ(Math.PI/2),a}r.exports=n},{}],3:[function(e,r,a){function n(e,r){var a=e.load("/textures/floor_metal.jpg");a.wrapS=THREE.RepeatWrapping,a.wrapT=THREE.RepeatWrapping,a.repeat.set(75,75),a.anisotropy=r.getMaxAnisotropy();var n=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:a}),t=new THREE.PlaneGeometry(500,500);return floor=new THREE.Mesh(t,n),floor.rotation.x=-Math.PI/2,floor}r.exports=n},{}],4:[function(e,r,a){function n(e){var r=new THREE.CylinderGeometry(.7,.7,6,7),a=new THREE.MeshBasicMaterial({color:"#141414"});return hand=new THREE.Mesh(r,a),hand.position.set(15,6,e.position.z/2),hand}r.exports=n},{}],5:[function(e,r,a){function n(){var e=new THREE.BoxGeometry(.4,.3,30),r=new THREE.MeshBasicMaterial({color:"white"});lightsaber=new THREE.Mesh(e,r),lightsaber.position.setY(15);var a=new THREE.BoxGeometry(.5,.4,30),n=new THREE.MeshBasicMaterial({transparent:!0,opacity:.5,color:"#ccc"}),t=new THREE.Mesh(a,n);return lightsaber.add(t),lightsaber}r.exports=n},{}],6:[function(e,r,a){function n(e){var r=new THREE.SphereGeometry(1e4,1e4,25,25),a=new THREE.MeshBasicMaterial({map:e.load("textures/floor_metal.jpg"),side:THREE.BackSide}),n=new THREE.Mesh(r,a);return n.rotateY(-Math.PI/2),n}r.exports=n},{}],7:[function(e,r,a){function n(){var e=new THREE.CylinderGeometry(.7,.7,6,7),r=new THREE.MeshBasicMaterial({color:"#ffff00"});return enemy_1=new THREE.Mesh(e,r),enemy_1.position.set(15,-1e3,0),enemy_1}r.exports=n},{}],8:[function(e,r,a){function n(){this.raycaster=new THREE.Raycaster,this.collidableMeshList=[],this.collidedMeshes=[]}n.prototype.getRandomInRange=function(e,r){return Math.random()*(r-e)+e},n.prototype.playAudio=function(e){e.play()},n.prototype.checkCollision=function(e,r,a,n){a||(a=!1);for(var t=0;t<e.geometry.vertices.length;t++){var i=e.geometry.vertices[t].clone(),o=i.applyMatrix4(e.matrixWorld),s=o.sub(e.position);this.raycaster.set(e.position,s.clone().normalize());var l=this.raycaster.intersectObjects(this.collidableMeshList);if(l.length>0&&l[0].distance<s.length()){var d=l[0].object;if(d.name==r){if(a){for(var c=0;c<this.collidedMeshes.length;c++){var w=this.collidedMeshes[c];if(d.uuid==w)return}this.collidedMeshes.push(d.uuid)}n(d)}}}},n.prototype.cameraLookDir=function(e){var r=new THREE.Vector3(0,0,-1);return r.applyEuler(e.rotation,e.rotation.order),r},n.prototype.debugAxes=function(e,r){function a(e,r,a){return new THREE.Vector3(e,r,a)}function n(e,a,n){var t,i=new THREE.Geometry,o=new THREE.LineBasicMaterial({color:n,lineWidth:1});i.vertices.push(e,a),t=new THREE.Line(i,o),r.add(t)}n(a(-e,0,0),a(e,0,0),16711680),n(a(0,-e,0),a(0,e,0),65280),n(a(0,0,-e),a(0,0,e),255)};var t=new n;r.exports=t},{}],9:[function(e,r,a){function P(){T=!1,i=window.innerWidth,o=window.innerHeight,t=new THREE.Scene,s=new THREE.PerspectiveCamera(90,i/o,.001,2e4),l=new THREE.WebGLRenderer,d=new THREE.StereoEffect(l),c=new THREE.Clock,w=new THREE.TextureLoader,l.setSize(window.innerWidth,window.innerHeight),s.lookAt(0,0,0),s.position.set(0,15,0),t.add(s),h=document.getElementById("container"),g=l.domElement,m=new THREE.OrbitControls(s,g),m.target.set(s.position.x+.15,s.position.y,s.position.z),m.noPan=!0,m.noZoom=!0,isMobile&&(E=new DeviceOrientationController(s,l.domElement),E.connect()),$(".landing").fadeOut(100),$(".confirm-button").fadeOut(100),setTimeout(function(){setInterval(function(){timer>0&&(timer--,document.getElementById("timer").innerHTML=timer,60==timer?($("#timer").fadeIn(500),$("#timertitle").fadeIn(500),$("#score").fadeIn(500),$("#scoretitle").fadeIn(500),$("#introMessage").fadeOut(500)):0==timer&&F())},1e3)},5e3),h.appendChild(g),g.addEventListener("click",A,!1),L()}function L(){H=[];var e=new f(w);console.log(e),t.add(e),p=new G(w,l),t.add(p),y=new B(w),t.add(y),v=new x(s),R=new C,v.add(R),z.collidableMeshList.push(R),lightAngle=new THREE.PointLight(10066329,1,500),lightAngle.position.set(0,50,0),t.add(lightAngle);new THREE.AxisHelper(200);t.add(v),b=new S,t.add(b),requestAnimationFrame(_),I()}function I(){$("#introMessage").fadeIn(500)}function F(){$("#outroMessage").fadeIn(1e3),$("#winMessage").html("You have scored "+score+" points!"),$(".gameView").fadeOut(1e3)}function q(){t.add(v),u=new W,window.addEventListener("deviceorientation",Y,!0),window.setInterval(function(){var e=u.clone();e.position.set(200,z.getRandomInRange(5,25),z.getRandomInRange(-10,10)),e.name="laser",e.velocity=new THREE.Vector3(-1.2,0,0),H.push(e),z.collidableMeshList.push(e),t.add(e)},Math.floor(200*Math.random()+900))}function A(){h.requestFullscreen?h.requestFullscreen():h.msRequestFullscreen?h.msRequestFullscreen():h.mozRequestFullScreen?h.mozRequestFullScreen():h.webkitRequestFullscreen&&h.webkitRequestFullscreen()}function Y(e){e.alpha&&(E=new THREE.DeviceOrientationControls(s,!0),E.connect(),E.update(),window.removeEventListener("deviceorientation",Y,!0))}function k(e,r){var i,o,s,a=r.g?r.g*(Math.PI/180):0,n=r.b?r.b*(Math.PI/180):0,t=r.a?r.a*(Math.PI/180):0,c=new THREE.Euler;o=n,s=a,i=t,c.set(0,-s,o-Math.PI/2),e.quaternion.setFromEuler(c)}function O(){var e=window.innerWidth,r=window.innerHeight;s.aspect=e/r,s.updateProjectionMatrix(),l.setSize(e,r),d.setSize(e,r)}function _(){c.getElapsedTime();requestAnimationFrame(_),j(c.getDelta()),isMobile?d.render(t,s):l.render(t,s)}function j(e){O(),s.updateProjectionMatrix(),m.update(e);var r=z.cameraLookDir(s);Math.abs(1-r.x)<.01&&!T&&(q(),T=!0);var a=["/sounds/hit1.wav","/sounds/hit2.wav","/sounds/hit3.wav","/sounds/hit4.wav"];z.checkCollision(R.children[0],"laser",!0,function(e){if(e){n.emit("sendhit"),e.velocity=new THREE.Vector3(1,0,0),score++,document.getElementById("score").innerHTML=score;var r=new Audio(a[Math.floor(4*Math.random())]);0==gameOver&&r.play()}});for(var i=0;i<H.length;i++){var o=H[i];o.position.add(o.velocity),(o.position.x<-10||o.position.x>200)&&(t.remove(o),H.splice(i,1))}isMobile&&E.update()}function D(){console.log("Initiated powerAttack_1"),console.log(H)}var t,i,o,s,l,d,c,w,E,m,h,g,v,u,H,R,p,y,T,b,n=io(),f=e("../../assets/Sky"),G=e("../../assets/Floor"),B=e("../../assets/Corridor"),x=e("../../assets/Hand"),C=e("../../assets/Lightsaber"),W=e("../../assets/Laser"),S=e("../../assets/Enemy_1"),z=e("./utils");$(document).ready(function(){$(".confirm-button").click(function(){P(),_()})}),n.emit("viewerjoin",{room:roomId}),n.on("beginsetup",function(e){}),n.on("setupcomplete",function(e){$(".confirm-button").show(),n.emit("viewready")}),n.on("beginGame",function(e){console.log("Game has Begun"),changeColor(e.color),P(),_()}),n.on("updateorientation",function(e){v&&k(v,e)}),n.on("init_powerAttack_1",function(e){D()}),n.on("updatemotion",function(e){})},{"../../assets/Corridor":1,"../../assets/Laser":2,"../../assets/Floor":3,"../../assets/Hand":4,"../../assets/Lightsaber":5,"../../assets/Sky":6,"../../assets/Enemy_1":7,"./utils":8}]},{},[9]);