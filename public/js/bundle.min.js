if(/Mobi/.test(navigator.userAgent))var isMobile=!0;var score=0,timer=65,gameOver=!1;!function e(t,r,n){function a(i,s){if(!r[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return a(r?r:e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,r){function n(e){var t=new THREE.Object3D,r=new THREE.PlaneGeometry(100,150),n=e.load("/textures/wall_deathstar.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(5,5);var a=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:n}),o=new THREE.PlaneGeometry(100,70),i=new THREE.MeshBasicMaterial({color:"green"}),s=new THREE.PlaneGeometry(70,150),l=e.load("/textures/floor_metal.jpg");l.wrapS=THREE.RepeatWrapping,l.wrapT=THREE.RepeatWrapping,l.repeat.set(5,5);var c=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:l}),d=new THREE.Mesh(r,a);d.position.set(20,0,-35);var E=d.clone();E.position.set(20,0,35),E.rotateY(Math.PI);var u=new THREE.Mesh(s,c);u.rotateY(Math.PI/2),u.position.set(-20,0,0);var w=new THREE.Mesh(o,i);return w.rotateX(-Math.PI/2),w.position.set(-20,50,0),t.add(d,E,u,w),t}t.exports=n},{}],2:[function(e,t,r){function n(){var e=new THREE.SphereGeometry(.9,16,16),t=new THREE.MeshBasicMaterial({transparent:!0,opacity:.75,color:"#982121"}),r=new THREE.Mesh(e,t);return r.rotateZ(Math.PI/2),r}t.exports=n},{}],3:[function(e,t,r){function n(e,t){var r=e.load("/textures/floor_metal.jpg");r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(75,75),r.anisotropy=t.getMaxAnisotropy();var n=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:r}),a=new THREE.PlaneGeometry(500,500);return floor=new THREE.Mesh(a,n),floor.rotation.x=-Math.PI/2,floor}t.exports=n},{}],4:[function(e,t,r){function n(e){var t=new THREE.CylinderGeometry(.7,.7,6,7),r=new THREE.MeshBasicMaterial({color:"#141414"});return hand=new THREE.Mesh(t,r),hand.position.set(15,6,e.position.z/2),hand}t.exports=n},{}],5:[function(e,t,r){function n(){var e=new THREE.BoxGeometry(.4,30,.5),t=new THREE.MeshBasicMaterial({color:"white"});lightsaber=new THREE.Mesh(e,t),lightsaber.position.setY(15);var r=new THREE.BoxGeometry(.5,30,.4),n=new THREE.MeshBasicMaterial({transparent:!0,opacity:.5,color:"#ccc"}),a=new THREE.Mesh(r,n);return lightsaber.add(a),lightsaber}t.exports=n},{}],6:[function(e,t,r){function n(e){var t=new THREE.SphereGeometry(1e4,1e4,25,25),r=new THREE.MeshBasicMaterial({map:e.load("textures/floor_metal.jpg"),side:THREE.BackSide}),n=new THREE.Mesh(t,r);return n.rotateY(-Math.PI/2),n}t.exports=n},{}],7:[function(e,t,r){function n(){var e=new THREE.SphereGeometry(20,32,32),t=new THREE.MeshBasicMaterial({color:"#aa1212"});return enemy_1=new THREE.Mesh(e,t),enemy_1.position.set(15,-1e3,0),enemy_1}t.exports=n},{}],8:[function(e,t,r){function n(){this.raycaster=new THREE.Raycaster,this.collidableMeshList=[],this.collidedMeshes=[]}n.prototype.getRandomInRange=function(e,t){return Math.random()*(t-e)+e},n.prototype.playAudio=function(e){e.play()},n.prototype.checkCollision=function(e,t,r,n){r||(r=!1);for(var a=0;a<e.geometry.vertices.length;a++){var o=e.geometry.vertices[a].clone(),i=o.applyMatrix4(e.matrixWorld),s=i.sub(e.position);this.raycaster.set(e.position,s.clone().normalize());var l=this.raycaster.intersectObjects(this.collidableMeshList);if(l.length>0&&l[0].distance<s.length()){var c=l[0].object;if(c.name==t){if(r){for(var d=0;d<this.collidedMeshes.length;d++){var E=this.collidedMeshes[d];if(c.uuid==E)return}this.collidedMeshes.push(c.uuid)}n(c)}}}},n.prototype.cameraLookDir=function(e){var t=new THREE.Vector3(0,0,-1);return t.applyEuler(e.rotation,e.rotation.order),t},n.prototype.debugAxes=function(e,t){function r(e,t,r){return new THREE.Vector3(e,t,r)}function n(e,r,n){var a,o=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:n,lineWidth:1});o.vertices.push(e,r),a=new THREE.Line(o,i),t.add(a)}n(r(-e,0,0),r(e,0,0),16711680),n(r(0,-e,0),r(0,e,0),65280),n(r(0,0,-e),r(0,0,e),255)};var a=new n;t.exports=a},{}],9:[function(e,t,r){function L(){y=!1,o=window.innerWidth,i=window.innerHeight,a=new THREE.Scene,s=new THREE.PerspectiveCamera(90,o/i,.001,2e4),l=new THREE.WebGLRenderer,c=new THREE.StereoEffect(l),d=new THREE.Clock,E=new THREE.TextureLoader,l.setSize(window.innerWidth,window.innerHeight),s.lookAt(0,0,0),s.position.set(0,15,0),a.add(s),h=document.getElementById("container"),m=l.domElement,w=new THREE.OrbitControls(s,m),w.target.set(s.position.x+.15,s.position.y,s.position.z),w.noPan=!0,w.noZoom=!0,isMobile&&(u=new DeviceOrientationController(s,l.domElement),u.connect()),$(".landing").fadeOut(100),$(".confirm-button").fadeOut(100),setTimeout(function(){setInterval(function(){timer>0&&(timer--,document.getElementById("timer").innerHTML=timer,60==timer?($("#timer").fadeIn(500),$("#timertitle").fadeIn(500),$("#score").fadeIn(500),$("#scoretitle").fadeIn(500),$("#introMessage").fadeOut(500)):0==timer&&_())},1e3)},5e3),h.appendChild(m),m.addEventListener("click",A,!1),W()}function W(){v=[];var e=new b(E);console.log(e),a.add(e),R=new x(E,l),a.add(R),H=new G(E),a.add(H),p=new B(s),g=new C,p.add(g),P.collidableMeshList.push(g),lightAngle=new THREE.PointLight(10066329,1,500),lightAngle.position.set(0,50,0),a.add(lightAngle);new THREE.AxisHelper(200);a.add(p),T=new S,a.add(T),requestAnimationFrame(O),F()}function F(){$("#introMessage").fadeIn(500)}function _(){$("#outroMessage").fadeIn(1e3),$("#winMessage").html("You have scored "+score+" points!"),$(".gameView").fadeOut(1e3)}function q(){a.add(p),f=new I,window.addEventListener("deviceorientation",j,!0),window.setInterval(function(){var e=f.clone();e.position.set(200,P.getRandomInRange(5,25),P.getRandomInRange(-10,10)),e.name="laser",e.velocity=new THREE.Vector3(-1.2,0,0),v.push(e),P.collidableMeshList.push(e),a.add(e)},Math.floor(200*Math.random()+900))}function A(){h.requestFullscreen?h.requestFullscreen():h.msRequestFullscreen?h.msRequestFullscreen():h.mozRequestFullScreen?h.mozRequestFullScreen():h.webkitRequestFullscreen&&h.webkitRequestFullscreen()}function j(e){e.alpha&&(u=new THREE.DeviceOrientationControls(s,!0),u.connect(),u.update(),window.removeEventListener("deviceorientation",j,!0))}function z(e,t){var o,i,s,r=t.g?t.g*(Math.PI/180):0,n=t.b?t.b*(Math.PI/180):0,a=t.a?t.a*(Math.PI/180):0,d=new THREE.Euler;i=n,s=r,o=a,d.set(0,-s,i-Math.PI/2),e.quaternion.setFromEuler(d)}function k(){var e=window.innerWidth,t=window.innerHeight;s.aspect=e/t,s.updateProjectionMatrix(),l.setSize(e,t),c.setSize(e,t)}function O(){d.getElapsedTime();requestAnimationFrame(O),D(d.getDelta()),isMobile?c.render(a,s):l.render(a,s)}function D(e){k(),s.updateProjectionMatrix(),w.update(e);var t=P.cameraLookDir(s);Math.abs(1-t.x)<.01&&!y&&(q(),y=!0);var r=["/sounds/hit1.wav","/sounds/hit2.wav","/sounds/hit3.wav","/sounds/hit4.wav"];P.checkCollision(g.children[0],"laser",!0,function(e){if(e){n.emit("sendhit"),e.velocity=new THREE.Vector3(1,0,0),score++,document.getElementById("score").innerHTML=score;var t=new Audio(r[Math.floor(4*Math.random())]);0==gameOver&&t.play()}});for(var o=0;o<v.length;o++){var i=v[o];i.position.add(i.velocity),(i.position.x<-10||i.position.x>200)&&(a.remove(i),v.splice(o,1))}isMobile&&u.update()}function Y(){console.log("Initiated powerAttack_1"),console.log(v)}var a,o,i,s,l,c,d,E,u,w,h,m,p,f,v,g,R,H,y,T,n=io(),b=e("../../assets/Sky"),x=e("../../assets/Floor"),G=e("../../assets/Corridor"),B=e("../../assets/Hand"),C=e("../../assets/Lightsaber"),I=e("../../assets/Laser"),S=e("../../assets/Enemy_1"),P=e("./utils");$(document).ready(function(){$(".confirm-button").click(function(){L(),O()})}),n.emit("viewerjoin",{room:roomId}),n.on("beginsetup",function(e){}),n.on("setupcomplete",function(e){$(".confirm-button").show(),n.emit("viewready")}),n.on("beginGame",function(e){console.log("Game has Begun"),changeColor(e.color),L(),O()}),n.on("updateorientation",function(e){p&&z(p,e)}),n.on("init_powerAttack_1",function(e){Y()}),n.on("updatemotion",function(e){})},{"../../assets/Corridor":1,"../../assets/Laser":2,"../../assets/Floor":3,"../../assets/Hand":4,"../../assets/Lightsaber":5,"../../assets/Sky":6,"../../assets/Enemy_1":7,"./utils":8}]},{},[9]);