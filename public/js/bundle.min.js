if(/Mobi/.test(navigator.userAgent))var isMobile=!0;var score=0,timer=65,gameOver=!1;!function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return a(n?n:e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){function r(e){var t=new THREE.Object3D,n=new THREE.PlaneGeometry(1450,475),r=e.load("/textures/dojo_wall.jpg");r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(3,1);var a=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:r}),o=new THREE.PlaneGeometry(100,70),i=new THREE.MeshBasicMaterial({color:"green"}),s=new THREE.PlaneGeometry(70,150),l=e.load("/textures/dojo_back.jpg");l.wrapS=THREE.RepeatWrapping,l.wrapT=THREE.RepeatWrapping,l.repeat.set(5,5);var c=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:l}),u=new THREE.Mesh(n,a);u.position.set(20,0,-35);var d=u.clone();d.position.set(20,0,35),d.rotateY(Math.PI);var E=new THREE.Mesh(s,c);E.rotateY(Math.PI/2),E.position.set(-20,0,0);var p=new THREE.Mesh(o,i);return p.rotateX(-Math.PI/2),p.position.set(-20,50,0),t.add(u,d,E,p),t}t.exports=r},{}],2:[function(e,t,n){function r(){var e=new THREE.SphereGeometry(1,32,32),t=new THREE.MeshBasicMaterial({color:16750848}),n=(new THREE.TextureLoader).load("/textures/orange.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(1,1),t.map=n;var r=new THREE.Mesh(e,t);return r.rotateZ(Math.PI/2),r}t.exports=r},{}],3:[function(e,t,n){function r(e,t){var n=e.load("/textures/floor_metal.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(75,75),n.anisotropy=t.getMaxAnisotropy();var r=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:n}),a=new THREE.PlaneGeometry(500,500);return floor=new THREE.Mesh(a,r),floor.rotation.x=-Math.PI/2,floor}t.exports=r},{}],4:[function(e,t,n){function r(e){var t=new THREE.CylinderGeometry(.7,.7,6,7),n=new THREE.MeshBasicMaterial({color:"#141414"});return hand=new THREE.Mesh(t,n),hand.position.set(15,6,e.position.z/2),hand}t.exports=r},{}],5:[function(e,t,n){function r(){var e=new THREE.BoxGeometry(.4,30,.5),t=new THREE.MeshBasicMaterial({color:"white"});lightsaber=new THREE.Mesh(e,t),lightsaber.position.setY(15);var n=new THREE.BoxGeometry(.5,30,.4),r=new THREE.MeshBasicMaterial({transparent:!0,opacity:.5,color:"#ccc"}),a=new THREE.Mesh(n,r);return lightsaber.add(a),lightsaber}t.exports=r},{}],6:[function(e,t,n){function r(e){var t=new THREE.SphereGeometry(1e4,1e4,25,25),n=new THREE.MeshBasicMaterial({map:e.load("textures/floor_metal.jpg"),side:THREE.BackSide}),r=new THREE.Mesh(t,n);return r.rotateY(-Math.PI/2),r}t.exports=r},{}],7:[function(e,t,n){function r(){var e=new THREE.SphereGeometry(20,32,32),t=new THREE.MeshBasicMaterial({color:"#aa1212"});return enemy_1=new THREE.Mesh(e,t),enemy_1.position.set(15,-1e3,0),enemy_1}t.exports=r},{}],8:[function(e,t,n){function r(){this.raycaster=new THREE.Raycaster,this.collidableMeshList=[],this.collidedMeshes=[]}r.prototype.getRandomInRange=function(e,t){return Math.random()*(t-e)+e},r.prototype.playAudio=function(e){e.play()},r.prototype.checkCollision=function(e,t,n,r){n||(n=!1);for(var a=0;a<e.geometry.vertices.length;a++){var o=e.geometry.vertices[a].clone(),i=o.applyMatrix4(e.matrixWorld),s=i.sub(e.position);this.raycaster.set(e.position,s.clone().normalize());var l=this.raycaster.intersectObjects(this.collidableMeshList);if(l.length>0&&l[0].distance<s.length()){var c=l[0].object;if(c.name==t){if(n){for(var u=0;u<this.collidedMeshes.length;u++){var d=this.collidedMeshes[u];if(c.uuid==d)return}this.collidedMeshes.push(c.uuid)}r(c)}}}},r.prototype.cameraLookDir=function(e){var t=new THREE.Vector3(0,0,-1);return t.applyEuler(e.rotation,e.rotation.order),t},r.prototype.debugAxes=function(e,t){function n(e,t,n){return new THREE.Vector3(e,t,n)}function r(e,n,r){var a,o=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:r,lineWidth:1});o.vertices.push(e,n),a=new THREE.Line(o,i),t.add(a)}r(n(-e,0,0),n(e,0,0),16711680),r(n(0,-e,0),n(0,e,0),65280),r(n(0,0,-e),n(0,0,e),255)};var a=new r;t.exports=a},{}],9:[function(e,t,n){function F(){H=!1,o=window.innerWidth,i=window.innerHeight,a=new THREE.Scene,s=new THREE.PerspectiveCamera(90,o/i,.001,2e4),l=new THREE.WebGLRenderer,c=new THREE.StereoEffect(l),u=new THREE.Clock,d=new THREE.TextureLoader,l.setSize(window.innerWidth,window.innerHeight),s.lookAt(0,0,0),s.position.set(0,15,0),a.add(s),h=document.getElementById("container"),f=l.domElement,p=new THREE.OrbitControls(s,f),p.target.set(s.position.x+.15,s.position.y,s.position.z),p.noPan=!0,p.noZoom=!0,isMobile&&(E=new DeviceOrientationController(s,l.domElement),E.connect()),$(".landing").fadeOut(100),$(".confirm-button").fadeOut(100),setTimeout(function(){setInterval(function(){timer>0&&(timer--,document.getElementById("timer").innerHTML=timer,60==timer?($("#timer").fadeIn(500),$("#timertitle").fadeIn(500),$("#score").fadeIn(500),$("#scoretitle").fadeIn(500),$("#introMessage").fadeOut(500)):0==timer&&k())},1e3)},5e3),h.appendChild(f),f.addEventListener("click",_,!1),C()}function C(){m=[];var e=new b(d);console.log(e),a.add(e),g=new x(d,l),a.add(g),M=new I(d),a.add(M),w=new S(s),R=new P,w.add(R),B.collidableMeshList.push(R),lightAngle=new THREE.PointLight(10066329,1,500),lightAngle.position.set(0,50,0),a.add(lightAngle);new THREE.AxisHelper(200);a.add(w),y=new G,a.add(y),requestAnimationFrame(z),q()}function q(){$("#introMessage").fadeIn(500)}function k(){$("#outroMessage").fadeIn(1e3),$("#winMessage").html("You have scored "+score+" points!"),$(".gameView").fadeOut(1e3)}function W(){a.add(w),v=new L,window.addEventListener("deviceorientation",O,!0),window.setInterval(function(){var e=v.clone();e.position.set(20,100,B.getRandomInRange(-10,10)),e.name="laser",e.velocity=new THREE.Vector3(0,-.25,0),m.push(e),B.collidableMeshList.push(e),a.add(e)},Math.floor(200*Math.random()+900))}function _(){h.requestFullscreen?h.requestFullscreen():h.msRequestFullscreen?h.msRequestFullscreen():h.mozRequestFullScreen?h.mozRequestFullScreen():h.webkitRequestFullscreen&&h.webkitRequestFullscreen()}function O(e){e.alpha&&(E=new THREE.DeviceOrientationControls(s,!0),E.connect(),E.update(),window.removeEventListener("deviceorientation",O,!0))}function A(e,t){var o,i,s,n=t.g?t.g*(Math.PI/180):0,r=t.b?t.b*(Math.PI/180):0,a=t.a?t.a*(Math.PI/180):0,u=new THREE.Euler;i=r,s=n,o=a,u.set(0,-s,i-Math.PI/2),e.quaternion.setFromEuler(u)}function j(){var e=window.innerWidth,t=window.innerHeight;s.aspect=e/t,s.updateProjectionMatrix(),l.setSize(e,t),c.setSize(e,t)}function z(){u.getElapsedTime();requestAnimationFrame(z),D(u.getDelta()),isMobile?c.render(a,s):l.render(a,s)}function D(e){j(),s.updateProjectionMatrix(),p.update(e);var t=B.cameraLookDir(s);Math.abs(1-t.x)<.01&&!H&&(W(),H=!0);var n=["/sounds/hit1.wav","/sounds/hit2.wav","/sounds/hit3.wav","/sounds/hit4.wav"];B.checkCollision(R.children[0],"laser",!0,function(e){if(e){r.emit("sendhit"),e.velocity=new THREE.Vector3(1,0,0),score++,document.getElementById("score").innerHTML=score;var t=new Audio(n[Math.floor(4*Math.random())]);0==gameOver&&t.play()}});for(var o=0;o<m.length;o++){var i=m[o];i.position.add(i.velocity),(i.position.y<-10||i.position.y>200)&&(a.remove(i),m.splice(o,1))}isMobile&&E.update()}var a,o,i,s,l,c,u,d,E,p,h,f,w,v,m,R,g,M,H,y,r=io(),b=e("../../assets/Sky"),x=e("../../assets/Floor"),I=e("../../assets/Corridor"),S=e("../../assets/Hand"),P=e("../../assets/Lightsaber"),L=e("../../assets/Laser"),G=e("../../assets/Enemy_1"),B=e("./utils");$(document).ready(function(){$(".confirm-button").click(function(){F(),z()})}),r.emit("viewerjoin",{room:roomId}),r.on("beginsetup",function(e){}),r.on("setupcomplete",function(e){$(".confirm-button").show(),r.emit("viewready")}),r.on("beginGame",function(e){console.log("Training is starting..."),F(),z()}),r.on("updateorientation",function(e){w&&A(w,e)}),r.on("updatemotion",function(e){})},{"../../assets/Corridor":1,"../../assets/Laser":2,"../../assets/Floor":3,"../../assets/Hand":4,"../../assets/Lightsaber":5,"../../assets/Sky":6,"../../assets/Enemy_1":7,"./utils":8}]},{},[9]);