if(/Mobi/.test(navigator.userAgent))var isMobile=!0;var score=0,timer=65,gameOver=!1;!function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[i]={exports:{}};t[i][0].call(d.exports,function(e){var n=t[i][1][e];return a(n?n:e)},d,d.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){function r(e){var t=new THREE.Object3D,n=new THREE.PlaneGeometry(100,150),r=e.load("/textures/wall_deathstar.jpg");r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(5,5);var a=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:r}),o=new THREE.PlaneGeometry(100,70),i=new THREE.MeshBasicMaterial({color:"green"}),s=new THREE.PlaneGeometry(70,150),l=e.load("/textures/floor_metal.jpg");l.wrapS=THREE.RepeatWrapping,l.wrapT=THREE.RepeatWrapping,l.repeat.set(5,5);var c=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:l}),d=new THREE.Mesh(n,a);d.position.set(20,0,-35);var u=d.clone();u.position.set(20,0,35),u.rotateY(Math.PI);var E=new THREE.Mesh(s,c);E.rotateY(Math.PI/2),E.position.set(-20,0,0);var h=new THREE.Mesh(o,i);return h.rotateX(-Math.PI/2),h.position.set(-20,50,0),t.add(d,u,E,h),t}t.exports=r},{}],2:[function(e,t,n){function r(){var e=new THREE.SphereGeometry(.9,16,16),t=new THREE.MeshBasicMaterial({transparent:!0,opacity:.75,color:"#982121"}),n=new THREE.Mesh(e,t);return n.rotateZ(Math.PI/2),n}t.exports=r},{}],3:[function(e,t,n){function r(e,t){var n=e.load("/textures/floor_metal.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(75,75),n.anisotropy=t.getMaxAnisotropy();var r=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:n}),a=new THREE.PlaneGeometry(500,500);return floor=new THREE.Mesh(a,r),floor.rotation.x=-Math.PI/2,floor}t.exports=r},{}],4:[function(e,t,n){function r(e){var t=new THREE.CylinderGeometry(.7,.7,6,7),n=new THREE.MeshBasicMaterial({color:"#141414"});return hand=new THREE.Mesh(t,n),hand.position.set(15,6,e.position.z/2),hand}t.exports=r},{}],5:[function(e,t,n){function r(){var e=new THREE.BoxGeometry(.4,30,.5),t=new THREE.MeshBasicMaterial({color:"white"});lightsaber=new THREE.Mesh(e,t),lightsaber.position.setY(15);var n=new THREE.BoxGeometry(.5,30,.4),r=new THREE.MeshBasicMaterial({transparent:!0,opacity:.5,color:"#ccc"}),a=new THREE.Mesh(n,r);return lightsaber.add(a),lightsaber}t.exports=r},{}],6:[function(e,t,n){function r(e){var t=new THREE.SphereGeometry(1e4,1e4,25,25),n=new THREE.MeshBasicMaterial({map:e.load("textures/floor_metal.jpg"),side:THREE.BackSide}),r=new THREE.Mesh(t,n);return r.rotateY(-Math.PI/2),r}t.exports=r},{}],7:[function(e,t,n){function r(){var e=new THREE.SphereGeometry(20,32,32),t=new THREE.MeshBasicMaterial({color:"#aa1212"});return enemy_1=new THREE.Mesh(e,t),enemy_1.position.set(15,-1e3,0),enemy_1}t.exports=r},{}],8:[function(e,t,n){function r(){this.raycaster=new THREE.Raycaster,this.collidableMeshList=[],this.collidedMeshes=[]}r.prototype.getRandomInRange=function(e,t){return Math.random()*(t-e)+e},r.prototype.playAudio=function(e){e.play()},r.prototype.checkCollision=function(e,t,n,r){n||(n=!1);for(var a=0;a<e.geometry.vertices.length;a++){var o=e.geometry.vertices[a].clone(),i=o.applyMatrix4(e.matrixWorld),s=i.sub(e.position);this.raycaster.set(e.position,s.clone().normalize());var l=this.raycaster.intersectObjects(this.collidableMeshList);if(l.length>0&&l[0].distance<s.length()){var c=l[0].object;if(c.name==t){if(n){for(var d=0;d<this.collidedMeshes.length;d++){var u=this.collidedMeshes[d];if(c.uuid==u)return}this.collidedMeshes.push(c.uuid)}r(c)}}}},r.prototype.cameraLookDir=function(e){var t=new THREE.Vector3(0,0,-1);return t.applyEuler(e.rotation,e.rotation.order),t},r.prototype.debugAxes=function(e,t){function n(e,t,n){return new THREE.Vector3(e,t,n)}function r(e,n,r){var a,o=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:r,lineWidth:1});o.vertices.push(e,n),a=new THREE.Line(o,i),t.add(a)}r(n(-e,0,0),n(e,0,0),16711680),r(n(0,-e,0),n(0,e,0),65280),r(n(0,0,-e),n(0,0,e),255)};var a=new r;t.exports=a},{}],9:[function(e,t,n){function C(){T=!1,o=window.innerWidth,i=window.innerHeight,a=new THREE.Scene,s=new THREE.PerspectiveCamera(90,o/i,.001,2e4),l=new THREE.WebGLRenderer,c=new THREE.StereoEffect(l),d=new THREE.Clock,u=new THREE.TextureLoader,l.setSize(window.innerWidth,window.innerHeight),s.lookAt(0,0,0),s.position.set(0,15,0),a.add(s),p=document.getElementById("container"),w=l.domElement,h=new THREE.OrbitControls(s,w),h.target.set(s.position.x+.15,s.position.y,s.position.z),h.noPan=!0,h.noZoom=!0,isMobile&&(E=new DeviceOrientationController(s,l.domElement),E.connect()),$(".landing").fadeOut(100),$(".confirm-button").fadeOut(100),setTimeout(function(){setInterval(function(){timer>0&&(timer--,document.getElementById("timer").innerHTML=timer,60==timer?($("#timer").fadeIn(500),$("#timertitle").fadeIn(500),$("#score").fadeIn(500),$("#scoretitle").fadeIn(500),$("#introMessage").fadeOut(500)):0==timer&&q())},1e3)},5e3),p.appendChild(w),w.addEventListener("click",A,!1),F()}function F(){v=[];var e=new b(u);console.log(e),a.add(e),R=new x(u,l),a.add(R),M=new I(u),a.add(M),f=new S(s),g=new G,f.add(g),B.collidableMeshList.push(g);var t=new THREE.SpotLight(16777215);t.position.set(-2,2,8),t.castShadow=!0,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024,t.shadow.camera.near=500,t.shadow.camera.far=4e3,t.shadow.camera.fov=30,a.add(t);new THREE.AxisHelper(200);a.add(f),y=new L,a.add(y),requestAnimationFrame(z),W()}function W(){$("#introMessage").fadeIn(500)}function q(){$("#outroMessage").fadeIn(1e3),$("#winMessage").html("You have scored "+score+" points!"),$(".gameView").fadeOut(1e3)}function _(){a.add(f),m=new P,window.addEventListener("deviceorientation",k,!0),window.setInterval(function(){var e=m.clone();e.position.set(50,200,B.getRandomInRange(-10,10)),e.name="laser",e.velocity=new THREE.Vector3(0,-1.2,0),v.push(e),B.collidableMeshList.push(e),a.add(e)},Math.floor(200*Math.random()+900))}function A(){p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen()}function k(e){e.alpha&&(E=new THREE.DeviceOrientationControls(s,!0),E.connect(),E.update(),window.removeEventListener("deviceorientation",k,!0))}function O(e,t){var o,i,s,n=t.g?t.g*(Math.PI/180):0,r=t.b?t.b*(Math.PI/180):0,a=t.a?t.a*(Math.PI/180):0,d=new THREE.Euler;i=r,s=n,o=a,d.set(0,-s,i-Math.PI/2),e.quaternion.setFromEuler(d)}function j(){var e=window.innerWidth,t=window.innerHeight;s.aspect=e/t,s.updateProjectionMatrix(),l.setSize(e,t),c.setSize(e,t)}function z(){d.getElapsedTime();requestAnimationFrame(z),D(d.getDelta()),isMobile?c.render(a,s):l.render(a,s)}function D(e){j(),s.updateProjectionMatrix(),h.update(e);var t=B.cameraLookDir(s);Math.abs(1-t.x)<.01&&!T&&(_(),T=!0);var n=["/sounds/hit1.wav","/sounds/hit2.wav","/sounds/hit3.wav","/sounds/hit4.wav"];B.checkCollision(g.children[0],"laser",!0,function(e){if(e){r.emit("sendhit"),e.velocity=new THREE.Vector3(1,0,0),score++,document.getElementById("score").innerHTML=score;var t=new Audio(n[Math.floor(4*Math.random())]);0==gameOver&&t.play()}});for(var o=0;o<v.length;o++){var i=v[o];i.position.add(i.velocity),(i.position.y<-10||i.position.y>200)&&(a.remove(i),v.splice(o,1))}isMobile&&E.update()}function Y(){console.log("Initiated powerAttack_1"),console.log(v)}var a,o,i,s,l,c,d,u,E,h,p,w,f,m,v,g,R,M,T,y,r=io(),b=e("../../assets/Sky"),x=e("../../assets/Floor"),I=e("../../assets/Corridor"),S=e("../../assets/Hand"),G=e("../../assets/Lightsaber"),P=e("../../assets/Laser"),L=e("../../assets/Enemy_1"),B=e("./utils");$(document).ready(function(){$(".confirm-button").click(function(){C(),z()})}),r.emit("viewerjoin",{room:roomId}),r.on("beginsetup",function(e){}),r.on("setupcomplete",function(e){$(".confirm-button").show(),r.emit("viewready")}),r.on("beginGame",function(e){console.log("Game has Begun"),C(),z()}),r.on("updateorientation",function(e){f&&O(f,e)}),r.on("init_powerAttack_1",function(e){Y()}),r.on("updatemotion",function(e){})},{"../../assets/Corridor":1,"../../assets/Laser":2,"../../assets/Floor":3,"../../assets/Hand":4,"../../assets/Lightsaber":5,"../../assets/Sky":6,"../../assets/Enemy_1":7,"./utils":8}]},{},[9]);