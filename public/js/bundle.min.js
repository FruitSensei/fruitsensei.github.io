function changeColor(e){"blue"==e?(lightsaberColor="#00ffff",laserColor="#ff3346"):"green"==e?(lightsaberColor="#05B805",laserColor="#ff3346"):"red"==e&&(lightsaberColor="#ff0000",laserColor="#00ffff")}function changeBlue(){document.getElementById("blueSaber").style.opacity="1",document.getElementById("redSaber").style.opacity="0.5",document.getElementById("greenSaber").style.opacity="0.5",lightsaberColor="#00ffff",laserColor="#ff3346"}function changeGreen(){document.getElementById("greenSaber").style.opacity="1",document.getElementById("blueSaber").style.opacity="0.5",document.getElementById("redSaber").style.opacity="0.5",lightsaberColor="#05B805",laserColor="#ff3346"}function changeRed(){document.getElementById("redSaber").style.opacity="1",document.getElementById("blueSaber").style.opacity="0.5",document.getElementById("greenSaber").style.opacity="0.5",lightsaberColor="#ff0000",laserColor="#00ffff"}if(/Mobi/.test(navigator.userAgent))var isMobile=!0;var score=0,timer=65,gameOver=!1,lightsaberColor="#00ffff",laserColor="#ff3346";!function e(r,n,t){function a(o,s){if(!n[o]){if(!r[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[o]={exports:{}};r[o][0].call(c.exports,function(e){var n=r[o][1][e];return a(n?n:e)},c,c.exports,e,r,n,t)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<t.length;o++)a(t[o]);return a}({1:[function(e,r,n){function t(e){var r=new THREE.Object3D,n=new THREE.PlaneGeometry(100,150),t=e.load("/textures/wall_deathstar.jpg");t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,t.repeat.set(5,5);var a=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:t}),i=new THREE.PlaneGeometry(100,70),o=new THREE.MeshBasicMaterial({color:"green"}),s=new THREE.PlaneGeometry(70,150),l=e.load("/textures/floor_metal.jpg");l.wrapS=THREE.RepeatWrapping,l.wrapT=THREE.RepeatWrapping,l.repeat.set(5,5);var d=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:l}),c=new THREE.Mesh(n,a);c.position.set(20,0,-35);var w=c.clone();w.position.set(20,0,35),w.rotateY(Math.PI);var E=new THREE.Mesh(s,d);E.rotateY(Math.PI/2),E.position.set(-20,0,0);var m=new THREE.Mesh(i,o);return m.rotateX(-Math.PI/2),m.position.set(-20,50,0),r.add(c,w,E,m),r}r.exports=t},{}],2:[function(e,r,n){function t(){var e=new THREE.CylinderGeometry(.9,.9,4,12),r=new THREE.MeshBasicMaterial({transparent:!0,opacity:.75,color:laserColor}),n=new THREE.Mesh(e,r);return n.rotateZ(Math.PI/2),n}r.exports=t},{}],3:[function(e,r,n){function t(e,r){var n=e.load("/textures/floor_metal.jpg");n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(75,75),n.anisotropy=r.getMaxAnisotropy();var t=new THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:5,shading:THREE.FlatShading,map:n}),a=new THREE.PlaneGeometry(500,500);return floor=new THREE.Mesh(a,t),floor.rotation.x=-Math.PI/2,floor}r.exports=t},{}],4:[function(e,r,n){function t(e){var r=new THREE.CylinderGeometry(.7,.7,6,7),n=new THREE.MeshBasicMaterial({color:"#141414"});return hand=new THREE.Mesh(r,n),hand.position.set(15,6,e.position.z/2),hand}r.exports=t},{}],5:[function(e,r,n){function t(){var e=new THREE.BoxGeometry(.4,30,.5),r=new THREE.MeshBasicMaterial({color:"white"});lightsaber=new THREE.Mesh(e,r),lightsaber.position.setY(15);var n=new THREE.BoxGeometry(.5,30,.4),t=new THREE.MeshBasicMaterial({transparent:!0,opacity:.5,color:"#ccc"}),a=new THREE.Mesh(n,t);return lightsaber.add(a),lightsaber}r.exports=t},{}],6:[function(e,r,n){function t(e){var r=new THREE.SphereGeometry(1e4,1e4,25,25),n=new THREE.MeshBasicMaterial({map:e.load("textures/floor_metal.jpg"),side:THREE.BackSide}),t=new THREE.Mesh(r,n);return t.rotateY(-Math.PI/2),t}r.exports=t},{}],7:[function(e,r,n){function t(){var e=new THREE.CylinderGeometry(.7,.7,6,7),r=new THREE.MeshBasicMaterial({color:"#ffff00"});return enemy_1=new THREE.Mesh(e,r),enemy_1.position.set(15,-1e3,0),enemy_1}r.exports=t},{}],8:[function(e,r,n){function t(){this.raycaster=new THREE.Raycaster,this.collidableMeshList=[],this.collidedMeshes=[]}t.prototype.getRandomInRange=function(e,r){return Math.random()*(r-e)+e},t.prototype.playAudio=function(e){e.play()},t.prototype.checkCollision=function(e,r,n,t){n||(n=!1);for(var a=0;a<e.geometry.vertices.length;a++){var i=e.geometry.vertices[a].clone(),o=i.applyMatrix4(e.matrixWorld),s=o.sub(e.position);this.raycaster.set(e.position,s.clone().normalize());var l=this.raycaster.intersectObjects(this.collidableMeshList);if(l.length>0&&l[0].distance<s.length()){var d=l[0].object;if(d.name==r){if(n){for(var c=0;c<this.collidedMeshes.length;c++){var w=this.collidedMeshes[c];if(d.uuid==w)return}this.collidedMeshes.push(d.uuid)}t(d)}}}},t.prototype.cameraLookDir=function(e){var r=new THREE.Vector3(0,0,-1);return r.applyEuler(e.rotation,e.rotation.order),r},t.prototype.debugAxes=function(e,r){function n(e,r,n){return new THREE.Vector3(e,r,n)}function t(e,n,t){var a,i=new THREE.Geometry,o=new THREE.LineBasicMaterial({color:t,lineWidth:1});i.vertices.push(e,n),a=new THREE.Line(i,o),r.add(a)}t(n(-e,0,0),n(e,0,0),16711680),t(n(0,-e,0),n(0,e,0),65280),t(n(0,0,-e),n(0,0,e),255)};var a=new t;r.exports=a},{}],9:[function(e,r,n){function P(){T=!1,i=window.innerWidth,o=window.innerHeight,a=new THREE.Scene,s=new THREE.PerspectiveCamera(90,i/o,.001,2e4),l=new THREE.WebGLRenderer,d=new THREE.StereoEffect(l),c=new THREE.Clock,w=new THREE.TextureLoader,l.setSize(window.innerWidth,window.innerHeight),s.lookAt(0,0,0),s.position.set(0,15,0),a.add(s),h=document.getElementById("container"),g=l.domElement,m=new THREE.OrbitControls(s,g),m.target.set(s.position.x+.15,s.position.y,s.position.z),m.noPan=!0,m.noZoom=!0,isMobile&&(E=new DeviceOrientationController(s,l.domElement),E.connect()),$(".landing").fadeOut(100),$(".confirm-button").fadeOut(100),setTimeout(function(){setInterval(function(){timer>0&&(timer--,document.getElementById("timer").innerHTML=timer,60==timer?($("#timer").fadeIn(500),$("#timertitle").fadeIn(500),$("#score").fadeIn(500),$("#scoretitle").fadeIn(500),$("#introMessage").fadeOut(500)):0==timer&&F())},1e3)},5e3),h.appendChild(g),g.addEventListener("click",A,!1),z()}function z(){p=[];var e=new b(w);console.log(e),a.add(e),H=new G(w,l),a.add(H),y=new B(w),a.add(y),u=new x(s),R=new C,u.add(R),I.collidableMeshList.push(R),lightAngle=new THREE.PointLight(10066329,1,500),lightAngle.position.set(0,50,0),a.add(lightAngle);new THREE.AxisHelper(200);a.add(u),f=new W,a.add(f),requestAnimationFrame(O),L()}function L(){$("#introMessage").fadeIn(500)}function F(){$("#outroMessage").fadeIn(1e3),$("#winMessage").html("You have scored "+score+" points!"),$(".gameView").fadeOut(1e3)}function q(){a.add(u),v=new S,window.addEventListener("deviceorientation",j,!0),window.setInterval(function(){var e=v.clone();e.position.set(200,I.getRandomInRange(5,25),I.getRandomInRange(-10,10)),e.name="laser",e.velocity=new THREE.Vector3(-1.2,0,0),p.push(e),I.collidableMeshList.push(e),a.add(e)},Math.floor(200*Math.random()+900))}function A(){h.requestFullscreen?h.requestFullscreen():h.msRequestFullscreen?h.msRequestFullscreen():h.mozRequestFullScreen?h.mozRequestFullScreen():h.webkitRequestFullscreen&&h.webkitRequestFullscreen()}function j(e){e.alpha&&(E=new THREE.DeviceOrientationControls(s,!0),E.connect(),E.update(),window.removeEventListener("deviceorientation",j,!0))}function Y(e,r){var i,o,s,n=r.g?r.g*(Math.PI/180):0,t=r.b?r.b*(Math.PI/180):0,a=r.a?r.a*(Math.PI/180):0,c=new THREE.Euler;o=t,s=n,i=a,c.set(0,-s,o-Math.PI/2),e.quaternion.setFromEuler(c)}function k(){var e=window.innerWidth,r=window.innerHeight;s.aspect=e/r,s.updateProjectionMatrix(),l.setSize(e,r),d.setSize(e,r)}function O(){c.getElapsedTime();requestAnimationFrame(O),_(c.getDelta()),isMobile?d.render(a,s):l.render(a,s)}function _(e){k(),s.updateProjectionMatrix(),m.update(e);var r=I.cameraLookDir(s);Math.abs(1-r.x)<.01&&!T&&(q(),T=!0);var n=["/sounds/hit1.wav","/sounds/hit2.wav","/sounds/hit3.wav","/sounds/hit4.wav"];I.checkCollision(R.children[0],"laser",!0,function(e){if(e){t.emit("sendhit"),e.velocity=new THREE.Vector3(1,0,0),score++,document.getElementById("score").innerHTML=score;var r=new Audio(n[Math.floor(4*Math.random())]);0==gameOver&&r.play()}});for(var i=0;i<p.length;i++){var o=p[i];o.position.add(o.velocity),(o.position.x<-10||o.position.x>200)&&(a.remove(o),p.splice(i,1))}isMobile&&E.update()}function D(){console.log("Initiated powerAttack_1"),console.log(p)}var a,i,o,s,l,d,c,w,E,m,h,g,u,v,p,R,H,y,T,f,t=io(),b=e("../../assets/Sky"),G=e("../../assets/Floor"),B=e("../../assets/Corridor"),x=e("../../assets/Hand"),C=e("../../assets/Lightsaber"),S=e("../../assets/Laser"),W=e("../../assets/Enemy_1"),I=e("./utils");$(document).ready(function(){$(".confirm-button").click(function(){P(),O()})}),t.emit("viewerjoin",{room:roomId}),t.on("beginsetup",function(e){}),t.on("setupcomplete",function(e){$(".confirm-button").show(),t.emit("viewready")}),t.on("beginGame",function(e){console.log("Game has Begun"),changeColor(e.color),P(),O()}),t.on("updateorientation",function(e){u&&Y(u,e)}),t.on("init_powerAttack_1",function(e){D()}),t.on("updatemotion",function(e){})},{"../../assets/Corridor":1,"../../assets/Laser":2,"../../assets/Floor":3,"../../assets/Hand":4,"../../assets/Lightsaber":5,"../../assets/Sky":6,"../../assets/Enemy_1":7,"./utils":8}]},{},[9]);